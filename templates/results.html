{% extends "base.html" %}
{% block title %}Results{% endblock %}
{% block content %}

<div>

    <h1>Results for Project {{ response_data["code"] }} </h1>
    <button id="downloadCSV">Download CSV</button>

    {% for prompt, observations in response_data["observations_grouped"].items() %}
        <h2>{{ prompt }}</h2>
        <div>
            <select id="graph-type-{{ loop.index }}">
                <option value="bar">Bar Graph</option>
                <option value="line">Line Graph</option>
                <option value="scatter">Scatterplot</option>
            </select>
            <button onclick="generateGraph({{ loop.index }}, {{ observations_grouped | tojson }})">Generate Graph</button>
        </div>
        <div id="graph-container-{{ loop.index }}"></div>
        <table border="1">
            <thead>
                <tr>
                    <th>Value</th>
                    <th>Student ID</th>
                    <th>Time and Date</th>
                    <th>Comment</th>
                </tr>
            </thead>
            <tbody>
                {% for observation in observations %}
                    <tr>
                        <td>{{ observation.value }}</td>
                        <td>{{ observation.student_id }}</td>
                        <td>{{ observation.time_date }}</td>
                        <td>{{ observation.comment }}</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    {% endfor %}

</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="{{ url_for('static', filename='download.js') }}"></script>
<script src="{{ url_for('static', filename='graph.js') }}"></script>

{% endblock %}
